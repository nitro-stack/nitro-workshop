<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>5. Extras | Nitro Workshop</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/nitro.png">
  <meta name="theme-color" content="#0078d7">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#0078d7">
    <meta property="og:site_name" content="Nitro Workshop"><meta property="og:title" content="5. Extras"><meta property="og:description" content="Learn how to make Node.js serverless REST APIs with NestJS and Azure"><meta property="og:type" content="website"><meta property="og:url" content="https://nitro-stack.github.io/nitro-workshop/step5/"><meta property="og:image" content="https://nitro-stack.github.io/nitro-workshop/nitro.png"><meta name="twitter:title" content="5. Extras"><meta name="twitter:description" content="Learn how to make Node.js serverless REST APIs with NestJS and Azure"><meta name="twitter:url" content="https://nitro-stack.github.io/nitro-workshop/step5/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://nitro-stack.github.io/nitro-workshop/nitro.png"><meta name="twitter:label1" content="Written by"><meta name="twitter:data2" content="Yohan Lasorsa"><meta name="twitter:creator" content="@sinedied">
    <link rel="preload" href="/assets/css/0.styles.bef55414.css" as="style"><link rel="preload" href="/assets/js/app.a46cfba1.js" as="script"><link rel="preload" href="/assets/js/2.37837671.js" as="script"><link rel="preload" href="/assets/js/12.22981cf4.js" as="script"><link rel="prefetch" href="/assets/js/10.5ea12bf9.js"><link rel="prefetch" href="/assets/js/11.ff8aa475.js"><link rel="prefetch" href="/assets/js/13.f1264ff7.js"><link rel="prefetch" href="/assets/js/14.f7bcb862.js"><link rel="prefetch" href="/assets/js/15.686a4ae0.js"><link rel="prefetch" href="/assets/js/16.8fd0dd7c.js"><link rel="prefetch" href="/assets/js/3.c7002ef4.js"><link rel="prefetch" href="/assets/js/4.629eb8d2.js"><link rel="prefetch" href="/assets/js/5.6cf4e94b.js"><link rel="prefetch" href="/assets/js/6.e7bba530.js"><link rel="prefetch" href="/assets/js/7.bea097d6.js"><link rel="prefetch" href="/assets/js/8.e98e9367.js"><link rel="prefetch" href="/assets/js/9.6a72163e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bef55414.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/nitro.png" alt="Nitro Workshop" class="logo"> <span class="site-name can-hide">Nitro Workshop</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/intro.html" class="nav-link">Workshop</a></div><div class="nav-item"><a href="https://nitr.ooo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nitro website
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/nitro-stack/nitro-workshop" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/intro.html" class="nav-link">Workshop</a></div><div class="nav-item"><a href="https://nitr.ooo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nitro website
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/nitro-stack/nitro-workshop" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/intro.html" class="sidebar-link">Introduction</a></li><li><a href="/env.html" class="sidebar-link">0. Prerequisites</a></li><li><a href="/step1/" class="sidebar-link">1. Bootstrap project</a></li><li><a href="/step2/" class="sidebar-link">2. Deploy application</a></li><li><a href="/step3/" class="sidebar-link">3. Add database</a></li><li><a href="/step4/" class="sidebar-link">4. Integrate file upload</a></li><li><a href="/step5/" class="active sidebar-link">5. Extras</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/step5/#add-data-validation" class="sidebar-link">Add data validation</a></li><li class="sidebar-sub-header"><a href="/step5/#enable-cors" class="sidebar-link">Enable CORS</a></li><li class="sidebar-sub-header"><a href="/step5/#enable-authorization" class="sidebar-link">Enable authorization</a></li><li class="sidebar-sub-header"><a href="/step5/#write-tests" class="sidebar-link">Write tests</a></li></ul></li><li><a href="/conclusion.html" class="sidebar-link">Conclusion</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_5-extras"><a href="#_5-extras" class="header-anchor">#</a> 5. Extras</h1> <p>At this point, you already have a working full-featured serverless API, well done! 🎉</p> <p>NestJS is a very comprehensive framework, and there could be a lot more use-cases to cover for your specific needs. I encourage you to dive into the <a href="https://docs.nestjs.com/" target="_blank" rel="noopener noreferrer">NestJS documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to learn more about the techniques and tools you can use.</p> <p>If you have more time and feel like it, here are some extras points that I found interesting to cover, especially if you want to build enterprise apps.</p> <p>Note that each of these extra parts is entirely independent, so you can skip to the one you are the most interested in or do them in any order 😉.</p> <h2 id="add-data-validation"><a href="#add-data-validation" class="header-anchor">#</a> Add data validation</h2> <p>It is a best practice to check and validate any data received by an API.
What do you think would happen if you call your story creation endpoint, but without providing data?</p> <p>Let's try!</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">curl</span> http://localhost:7071/api/stories -X POST -d <span class="token string">&quot;&quot;</span>
</code></pre></div><p>Whoops! A new story is created, but with our entity properties are left empty 😱.</p> <p>We might want to make sure a new story has its <code>animal</code> field set and either a <code>description</code> or an image provided.</p> <p>Nest.js provides a built-in <code>ValidationPipe</code> that enforces validation rules for received data payloads, thanks to annotations provided by the <a href="https://github.com/typestack/class-validator" target="_blank" rel="noopener noreferrer"><code>class-validator</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> package.</p> <p>To use it, you have to create a DTO (<a href="https://en.wikipedia.org/wiki/Data_transfer_object" target="_blank" rel="noopener noreferrer">Data Transfer Object<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>) class on which you will declare the validations rules using annotations.</p> <p>First, you need to install the required packages:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> class-validator class-transformer
</code></pre></div><p>Then create the file <code>src/stories/story.dto.ts</code>:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">StoryDto</span> <span class="token punctuation">{</span>
  @<span class="token function">IsNotEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  animal<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  @<span class="token function">IsOptional</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  description<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  @<span class="token function">IsOptional</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  createdAt<span class="token operator">:</span> Date<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It looks like a lot like our <code>Story</code> entity, but this time you define only properties that are expected in the request payload. That's why there is no <code>imageUrl</code> property here: it will be set by the controller only if an image file is uploaded.</p> <p>The annotations <code>@IsNotEmpty()</code> and <code>@IsOptional()</code> describe which property can be omitted and which one can be set in the payload. You can see the complete list of provided decorators <a href="https://github.com/typestack/class-validator#validation-decorators" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Now open <code>src/stories/stories.controller.ts</code> and change the type of the <code>data</code> parameter of your <code>POST</code> function to <code>StoryDto</code>:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token operator">...</span>
<span class="token keyword">async</span> <span class="token function">createStory</span><span class="token punctuation">(</span>
  @<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  data<span class="token operator">:</span> StoryDto<span class="token punctuation">,</span>
  @<span class="token function">UploadedFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  file<span class="token operator">:</span> UploadedFileMetadata<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Story<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token operator">...</span>
</code></pre></div><p>Finally open <code>src/main.azure.ts</code> and enable <code>ValidationPipe</code> at the application level, to ensure all endpoints gets data validation:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">setGlobalPrefix</span><span class="token punctuation">(</span><span class="token string">'api'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">useGlobalPipes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValidationPipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Start your server with <code>npm run start:azure</code> and run the previous <code>curl</code> command again. This time you should properly receive an HTTP error <code>400</code> (bad request).</p> <div class="custom-block tip"><p class="custom-block-title">Pro tip</p> <p>By default, detailed error messages will be automatically generated in case of a validation error. You also specify custom error message in the decorator options, for example:</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">IsNotEmpty</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">'animal must not be empty'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
animal<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</code></pre></div><p>You also use special tokens in your error message or use a function for better granularity. See the <a href="https://github.com/typestack/class-validator#validation-messages" target="_blank" rel="noopener noreferrer"><code>class-validator</code> documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for more details.</p></div> <p>What about our other constraint, which is to have either a <code>description</code> or an image file provided?</p> <p>Since the <code>imageUrl</code> information is not directly part of the DTO, we cannot use it for validation. As the <code>imageUrl</code> property is set in the controller, that's where you have to perform manual validation. You can use the <a href="https://github.com/typestack/class-validator#manual-validation" target="_blank" rel="noopener noreferrer">manual validation methods<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> of the <code>class-validator</code> package for that.</p> <p>This time, it's your turn to finish the job!</p> <ul><li>Ensure that either <code>description</code> or <code>imageUrl</code> is not empty, using manual validation.</li> <li>Ensure that <code>description</code> length is at most 240 characters.</li> <li>Ensure that <code>animal</code> is either set to <code>cat</code>, <code>doc</code> or <code>hamster</code> using annotations.</li> <li>Ensure that <code>createdAt</code> is a date if provided, using annotations.</li></ul> <p>You can read more on data validation techniques in the <a href="https://docs.nestjs.com/techniques/validation" target="_blank" rel="noopener noreferrer">NestJS documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="enable-cors"><a href="#enable-cors" class="header-anchor">#</a> Enable CORS</h2> <p>If you try to access your API inside a web application from your browser, you might encounter an error like that one:</p> <p><img src="/assets/img/cors-error.8f5afbe2.jpg" alt="CORS error"></p> <p>This error occurs because browsers block HTTP requests from scripts to web domains different than the one of the current web page to improve security.</p> <p>To bypass this restriction, your server must define specific HTTP headers to allow it. This mechanism is called <a href="https://developer.mozilla.org/docs/Web/HTTP/CORS" target="_blank" rel="noopener noreferrer">Cross-Origin Resource Sharing<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (CORS).</p> <p>CORS is already enabled by default on Azure Functions but you must add your website domain to the list of allowed origins using this command:</p> <div class="language- extra-class"><pre class="language-text"><code># Don't forget to change the name and URL with your own
$ az functionapp cors add \
    --name funpets-api \
    --resource-group funpets \
    --allowed-origins https://yourwebsite.com
</code></pre></div><p>If you want to allow any website to use your API, you can replace the website URL by using <code>*</code> instead. In that case, be careful as Azure Functions will auto-scale to handle the workload if millions of users start using it, but so will your bill!</p> <h2 id="enable-authorization"><a href="#enable-authorization" class="header-anchor">#</a> Enable authorization</h2> <p>By default, all Azure Functions triggered by HTTP are publicly available. It's useful for a lot of scenarios, but at some point you might want to restrict who can execute your functions, in our case your API.</p> <p>Open the file <code>main/function.json</code>. In the functions, bindings, notice that <code>authLevel</code> is set to <code>anonymous</code>. It can be set to one of these 3 values:</p> <ul><li><code>anonymous</code>: no API key is required (default).</li> <li><code>function</code>: an API key specific to this function is required. If none is defined, the <code>default</code> one will be used.</li> <li><code>admin</code>: a host API key is required. It will be shared among all functions from the same app.</li></ul> <p>Now change <code>authLevel</code> to <code>function</code>, and redeploy your function:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># Don't forget to change the name with the one you used previously</span>
func azure functionapp publish <span class="token operator">&lt;</span>your-funpets-api<span class="token operator">&gt;</span> --nozip
</code></pre></div><p>Then try to invoke again your API:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">curl</span> https://<span class="token operator">&lt;</span>your-funpets-api<span class="token operator">&gt;</span>.azurewebsites.net/api/stories -i
</code></pre></div><p>You should get an HTTP status <code>401</code> error (<code>Unauthorized</code>).</p> <p>To call a protected function, you need to either provide the key as a query string parameter in the form <code>code=&lt;api_key&gt;</code> or you can provide it with the HTTP header <code>x-functions-key</code>.</p> <p>You can either log in to <a href="https://portal.azure.com?WT.mc_id=nitro-workshop-yolasors" target="_blank" rel="noopener noreferrer">portal.azure.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and go to your function app, or follow these steps to retrieve your function API keys:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>// Retrieve your resource ID
<span class="token comment"># Don't forget to change the name with the one you used previously</span>
az functionapp show --name <span class="token operator">&lt;</span>your-funpets-api<span class="token operator">&gt;</span> <span class="token punctuation">\</span>
                    --resource-group funpets <span class="token punctuation">\</span>
                    --query <span class="token function">id</span>

<span class="token comment"># Use the resource ID from the previous command</span>
az rest --method post --uri <span class="token string">&quot;&lt;resource_id&gt;/host/default/listKeys?api-version=2018-11-01&quot;</span>
</code></pre></div><p>You should see something like that:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;functionKeys&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;default&quot;</span><span class="token operator">:</span> <span class="token string">&quot;functionApiKey==&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;masterKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;masterApiKey==&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;systemKeys&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Then try to invoke again your API, this time with the <code>x-functions-key</code> header set with your function API key:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">curl</span> https://<span class="token operator">&lt;</span>your-funpets-api<span class="token operator">&gt;</span>.azurewebsites.net/api/stories -i <span class="token punctuation">\</span>
  -H <span class="token string">&quot;x-functions-key: &lt;your_function_api_key&gt;&quot;</span>
</code></pre></div><p>This time the call should succeed!</p> <p>Using authorization level you can restrict who can call your API, this can be useful especially for service-to-service access restrictions.</p> <p>However, if you need to manage finely who can access your API with an endpoint granularity, you need to implement <a href="https://docs.nestjs.com/techniques/authentication" target="_blank" rel="noopener noreferrer">authentication<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in your app.</p> <h2 id="write-tests"><a href="#write-tests" class="header-anchor">#</a> Write tests</h2> <p>Your API might currently look fine, but how can you ensure it has as little bugs as possible, and that you won't introduce regression in the future?</p> <p>Writing automated is not the most fun part of development, but it's a fundamental requirement to develop robust software applications. It helps to catch bugs early, preventing regressions and ensuring that production releases meet your quality and performance goals.</p> <p>The good news is NestJS has you covered to make your testing experience as smooth as possible.
When you bootstrapped the project using the <code>nest</code> CLI, <a href="https://jestjs.io" target="_blank" rel="noopener noreferrer">Jest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://github.com/visionmedia/supertest" target="_blank" rel="noopener noreferrer">SuperTest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> frameworks have been set up for you.</p> <p>Each time you run the <code>nest generate</code> command, unit test files are also created for you with the extension <code>.spec.ts</code>.</p> <p>There are 5 NPM scripts dedicated to testing in your <code>package.json</code> file:</p> <ul><li><code>npm test</code>: runs unit tests once.</li> <li><code>npm run test:watch</code> runs unit tests in watch mode, it will automatically re-run tests as you make modifications to the files. It is suited perfectly for <a href="https://en.wikipedia.org/wiki/Test-driven_development" target="_blank" rel="noopener noreferrer">TDD<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li><code>npm run test:cov</code> runs unit tests and generate coverage report, so you can know which code paths are covered by your tests.</li> <li><code>npm run test:debug</code>: runs unit tests with Node.js debugger enabled, so you can add breakpoints in your code editor and debug your tests more easily.</li> <li><code>npm run test:e2e</code>: runs your end-to-end tests.</li></ul> <p>Now run the <code>npm test</code> command. Oops, it seems that <code>src/stories/stories.controller.spec.ts</code> test if failing 😱!</p> <h3 id="add-module-and-providers-mocks"><a href="#add-module-and-providers-mocks" class="header-anchor">#</a> Add module and providers mocks</h3> <p>If you look at the stack trace, you can see that the reason is that <code>@nestjs/typeorm</code> and <code>AzureStorageModule</code> services cannot be resolved. It's expected: when running unit tests, you want to isolate the code you are testing as much as possible, and for that you can see that each test file provides its own module definition:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token keyword">module</span><span class="token operator">:</span> TestingModule <span class="token operator">=</span> <span class="token keyword">await</span> Test<span class="token punctuation">.</span><span class="token function">createTestingModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    controllers<span class="token operator">:</span> <span class="token punctuation">[</span>StoriesController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  controller <span class="token operator">=</span> <span class="token keyword">module</span><span class="token punctuation">.</span><span class="token keyword">get</span><span class="token operator">&lt;</span>StoriesController<span class="token operator">&gt;</span><span class="token punctuation">(</span>StoriesController<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The module created with <code>Test.createTestingModule</code> does not import <code>AzureTableStorageModule</code> and <code>AzureStorageModule</code>, so that's why their providers cannot be resolved. Instead of importing them right away to fix the issue, we should write <a href="https://en.wikipedia.org/wiki/Mock_object" target="_blank" rel="noopener noreferrer"><strong>mocks</strong><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for the providers we use instead.</p> <h4 id="mock-nestjs-azure-storage"><a href="#mock-nestjs-azure-storage" class="header-anchor">#</a> Mock <code>@nestjs/azure-storage</code></h4> <p>Let's start with mocking what we use in <code>@nestjs/azure-storage</code> module, using <code>jest.mock(&lt;module&gt;)</code> helper function. Add this code just after the imports:</p> <div class="language-ts extra-class"><pre class="language-ts"><code>jest<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">'@nestjs/azure-storage'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// Use Jest automatic mock generation</span>
  <span class="token operator">...</span>jest<span class="token punctuation">.</span><span class="token function">genMockFromModule</span><span class="token punctuation">(</span><span class="token string">'@nestjs/azure-storage'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token comment">// Mock interceptor</span>
  <span class="token function-variable function">AzureStorageFileInterceptor</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    intercept<span class="token operator">:</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>For simple modules, using <code>jest.mock(&lt;module&gt;)</code> would be enough to generate mocks automatically according to the module interface.</p> <p>But in our case, <code>AzureStorageFileInterceptor</code> needs to be mocked manually as it is a bit trickier: it must returns an object with a method <code>intercept(context, next)</code> that needs to call <code>next.handle()</code> to not break the chain of interceptors calls.</p> <p>So we provide our own version of the <code>@nestjs/azure-storage</code> module mock, using <code>jest.genMockFromModule(&lt;module&gt;)</code> helper to automatically generates mocks for everything except <code>AzureStorageFileInterceptor</code>.</p> <p>For <code>AzureStorageFileInterceptor</code> we manually reproduce a minimal implementation. Using <code>jest.fn()</code> method here creates a <a href="https://jestjs.io/docs/en/mock-function-api" target="_blank" rel="noopener noreferrer">mock function<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Thanks to that, we can later change its implementation in a specific test if needed.</p> <p>Then add <code>AzureStorageService</code> to the testting module <code>providers</code> list:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token keyword">module</span><span class="token operator">:</span> TestingModule <span class="token operator">=</span> <span class="token keyword">await</span> Test<span class="token punctuation">.</span><span class="token function">createTestingModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    controllers<span class="token operator">:</span> <span class="token punctuation">[</span>StoriesController<span class="token punctuation">]</span><span class="token punctuation">,</span>
    providers<span class="token operator">:</span> <span class="token punctuation">[</span>AzureStorageService<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  controller <span class="token operator">=</span> <span class="token keyword">module</span><span class="token punctuation">.</span><span class="token keyword">get</span><span class="token operator">&lt;</span>StoriesController<span class="token operator">&gt;</span><span class="token punctuation">(</span>StoriesController<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>And complete the missing import:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AzureStorageService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/azure-storage'</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="mock-nestjs-typeorm"><a href="#mock-nestjs-typeorm" class="header-anchor">#</a> Mock <code>@nestjs/typeorm</code></h4> <p>We also need to mock the <code>storiesRepository</code> service injected in our controller using <code>@InjectRepository(Story)</code>, but how to do that?</p> <p>This time we do not need to mock the entire module, but only this specific service.
We can still use Jest automatic mock generation:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Add this code after the imports</span>
<span class="token keyword">const</span> mockRepository <span class="token operator">=</span> jest<span class="token punctuation">.</span>genMockFromModule<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">'typeorm'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>MongoRepository<span class="token punctuation">;</span>
</code></pre></div><p>Its injection token is generated dynamically, so we need to add a <a href="https://docs.nestjs.com/fundamentals/custom-providers#custom-providers-1" target="_blank" rel="noopener noreferrer">custom provider<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to our testing module to reproduce the same behavior:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token keyword">module</span><span class="token operator">:</span> TestingModule <span class="token operator">=</span> <span class="token keyword">await</span> Test<span class="token punctuation">.</span><span class="token function">createTestingModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    controllers<span class="token operator">:</span> <span class="token punctuation">[</span>StoriesController<span class="token punctuation">]</span><span class="token punctuation">,</span>
      providers<span class="token operator">:</span> <span class="token punctuation">[</span>
        AzureStorageService<span class="token punctuation">,</span>
        <span class="token punctuation">{</span> provide<span class="token operator">:</span> <span class="token function">getRepositoryToken</span><span class="token punctuation">(</span>Story<span class="token punctuation">)</span><span class="token punctuation">,</span> useValue<span class="token operator">:</span> mockRepository <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  controller <span class="token operator">=</span> <span class="token keyword">module</span><span class="token punctuation">.</span><span class="token keyword">get</span><span class="token operator">&lt;</span>StoriesController<span class="token operator">&gt;</span><span class="token punctuation">(</span>StoriesController<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Pro tip</p> <p>We had to look at the implementation <code>@InjectRepository()</code> annotation to find out that it uses the method <code>getRepositoryToken()</code> internally. Unfortunately, that's something you have to do sometimes to be able to mock modules properly.</p></div> <p>Don't forget to add missing imports:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> getRepositoryToken <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/typeorm'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Story <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./story.entity'</span><span class="token punctuation">;</span>
</code></pre></div><p>Now run <code>npm test</code> again, this time the tests should succeed!</p> <h3 id="complete-test-suite"><a href="#complete-test-suite" class="header-anchor">#</a> Complete test suite</h3> <p>Hold on, now that we have solved the mock issue, it's time to write more tests 😃!</p> <p>Try to add:</p> <ul><li>Unit tests for your controller in <code>src/stories/stories.controller.ts</code>.</li> <li>An end-to-end for of your endpoints in <code>tests/app.e2e-spec.ts</code>.</li></ul> <p>Take also a look a the report generated by <code>npm run test:cov</code> to see your test coverage.</p> <p>If you are not familiar with Jest you might want to take a look at the <a href="https://jestjs.io/docs/en/using-matchers" target="_blank" rel="noopener noreferrer">documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
For end-to-end tests, HTTP assertions are made using the <a href="https://github.com/visionmedia/supertest" target="_blank" rel="noopener noreferrer">SuperTest library<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>You can also find examples and more information in the <a href="https://docs.nestjs.com/fundamentals/testing#unit-testing" target="_blank" rel="noopener noreferrer">NestJS documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <br> <hr> <p><strong>Solution:</strong> see the <a href="https://github.com/nitro-stack/nitro-workshop/tree/step5" target="_blank" rel="noopener noreferrer">code for extras<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/step4/" class="prev">4. Integrate file upload</a></span> <span class="next"><a href="/conclusion.html">Conclusion</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a46cfba1.js" defer></script><script src="/assets/js/2.37837671.js" defer></script><script src="/assets/js/12.22981cf4.js" defer></script>
  </body>
</html>
