<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2. Deploy application | Nitro Workshop</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/nitro-workshop/nitro.png">
  <meta name="theme-color" content="#0078d7">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#0078d7">
    <meta property="og:site_name" content="Nitro Workshop"><meta property="og:title" content="2. Deploy application"><meta property="og:description" content="Learn how to make Node.js serverless REST APIs with NestJS and Azure"><meta property="og:type" content="website"><meta property="og:url" content="https://nitro-stack.github.io/nitro-workshop/step2/"><meta property="og:image" content="https://nitro-stack.github.io/nitro-workshop/nitro.png"><meta name="twitter:title" content="2. Deploy application"><meta name="twitter:description" content="Learn how to make Node.js serverless REST APIs with NestJS and Azure"><meta name="twitter:url" content="https://nitro-stack.github.io/nitro-workshop/step2/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://nitro-stack.github.io/nitro-workshop/nitro.png"><meta name="twitter:label1" content="Written by"><meta name="twitter:data2" content="Yohan Lasorsa"><meta name="twitter:creator" content="@sinedied">
    <link rel="preload" href="/nitro-workshop/assets/css/0.styles.a1e28b27.css" as="style"><link rel="preload" href="/nitro-workshop/assets/js/app.72f1e144.js" as="script"><link rel="preload" href="/nitro-workshop/assets/js/2.37837671.js" as="script"><link rel="preload" href="/nitro-workshop/assets/js/10.2d5da0ed.js" as="script"><link rel="prefetch" href="/nitro-workshop/assets/js/11.5b590e3a.js"><link rel="prefetch" href="/nitro-workshop/assets/js/12.a176b819.js"><link rel="prefetch" href="/nitro-workshop/assets/js/13.f1264ff7.js"><link rel="prefetch" href="/nitro-workshop/assets/js/14.96d2f4bc.js"><link rel="prefetch" href="/nitro-workshop/assets/js/15.703b0f9c.js"><link rel="prefetch" href="/nitro-workshop/assets/js/16.8fd0dd7c.js"><link rel="prefetch" href="/nitro-workshop/assets/js/3.f40463cd.js"><link rel="prefetch" href="/nitro-workshop/assets/js/4.629eb8d2.js"><link rel="prefetch" href="/nitro-workshop/assets/js/5.6cf4e94b.js"><link rel="prefetch" href="/nitro-workshop/assets/js/6.d69e349b.js"><link rel="prefetch" href="/nitro-workshop/assets/js/7.1c6d1ffd.js"><link rel="prefetch" href="/nitro-workshop/assets/js/8.edd52f9a.js"><link rel="prefetch" href="/nitro-workshop/assets/js/9.f44a4e00.js">
    <link rel="stylesheet" href="/nitro-workshop/assets/css/0.styles.a1e28b27.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/nitro-workshop/" class="home-link router-link-active"><img src="/nitro-workshop/nitro.png" alt="Nitro Workshop" class="logo"> <span class="site-name can-hide">Nitro Workshop</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/nitro-workshop/" class="nav-link">Home</a></div><div class="nav-item"><a href="/nitro-workshop/intro.html" class="nav-link">Workshop</a></div><div class="nav-item"><a href="https://nitr.ooo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nitro website
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/nitro-stack/nitro-workshop" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/nitro-workshop/" class="nav-link">Home</a></div><div class="nav-item"><a href="/nitro-workshop/intro.html" class="nav-link">Workshop</a></div><div class="nav-item"><a href="https://nitr.ooo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nitro website
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/nitro-stack/nitro-workshop" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/nitro-workshop/intro.html" class="sidebar-link">Introduction</a></li><li><a href="/nitro-workshop/env.html" class="sidebar-link">0. Prerequisites</a></li><li><a href="/nitro-workshop/step1/" class="sidebar-link">1. Bootstrap project</a></li><li><a href="/nitro-workshop/step2/" class="active sidebar-link">2. Deploy application</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nitro-workshop/step2/#go-serverless" class="sidebar-link">Go serverless</a></li><li class="sidebar-sub-header"><a href="/nitro-workshop/step2/#create-the-resources" class="sidebar-link">Create the resources</a></li><li class="sidebar-sub-header"><a href="/nitro-workshop/step2/#deploy-your-app" class="sidebar-link">Deploy your app</a></li></ul></li><li><a href="/nitro-workshop/step3/" class="sidebar-link">3. Add database</a></li><li><a href="/nitro-workshop/step4/" class="sidebar-link">4. Integrate file upload</a></li><li><a href="/nitro-workshop/step5/" class="sidebar-link">5. Extras</a></li><li><a href="/nitro-workshop/conclusion.html" class="sidebar-link">Conclusion</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2-deploy-application"><a href="#_2-deploy-application" class="header-anchor">#</a> 2. Deploy application</h1> <p>Before going further with our API, let's deploy it, serverless way!</p> <blockquote><p>But we haven't done anything meaningful yet, shouldn't we integrate all our features before deploying?</p></blockquote> <p>Not at all! Deploying <strong>early</strong> and <strong>frequently</strong> is a factor of success in software development and a <a href="https://azure.microsoft.com/overview/what-is-devops/?WT.mc_id=nitro-workshop-yolasors" target="_blank" rel="noopener noreferrer">DevOps<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> best practice.</p> <h2 id="go-serverless"><a href="#go-serverless" class="header-anchor">#</a> Go serverless</h2> <p>Why serverless? Why not deploy our app using a container or a managed service, like <a href="https://docs.microsoft.com/azure/app-service/?WT.mc_id=nitro-workshop-yolasors" target="_blank" rel="noopener noreferrer">Azure App Service<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for instance? There are 2 main reasons for that:</p> <ul><li>You only pay for what you use, not for the resource allocation (and it's <a href="https://dev.to/azure/is-serverless-really-as-cheap-as-everyone-claims-4i9n" target="_blank" rel="noopener noreferrer">dead cheap<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</li> <li>It scales automatically without any additional setup</li></ul> <p>First, let's update our NestJS app into a serverless app so we can deploy it to <a href="https://docs.microsoft.com/azure/azure-functions/?WT.mc_id=nitro-workshop-yolasors" target="_blank" rel="noopener noreferrer">Azure Functions<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="custom-block info"><p class="custom-block-title">What's Azure Functions?</p> <p>It's a solution for running small pieces of code, or <em>functions</em>, in the cloud. You just write the code for the problem at hand in your preferred language, without worrying about the infrastructure or enclosing app to run it.</p></div> <p>Open a terminal and run this command:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>nest <span class="token function">add</span> @nestjs/azure-func-http
</code></pre></div><p>And... That's it. Really.</p> <p><img src="/nitro-workshop/assets/img/thats-it.fb910f3b.jpg" alt="grandma looking surprised"></p> <p>Thanks to the included schematics, your server code is now ready to be deployed on Azure Functions. And the best part is that nothing was changed in your code, it can still run locally like previously.</p> <p>If you take a closer look, here is what has been added:</p> <ul><li><code>main</code>: a folder containing the Azure Functions trigger config and entry point</li> <li><code>src/main.azure.ts</code>: an alternative entry point for your server app that will be used only on Azure Functions (thus leaving the regular entry point intact).</li> <li>Some config files in the project's root, we do not need to care about them for now.</li> <li>A new <code>start:azure</code> NPM script in your <code>package.json</code> file, allowing to run your API locally but with the Azure Functions simulator this time.</li></ul> <p>To be able to use the command <code>npm run start:azure</code>, you must have installed the <a href="https://docs.microsoft.com/azure/azure-functions/functions-run-local#v2?WT.mc_id=nitro-workshop-yolasors" target="_blank" rel="noopener noreferrer">Azure Functions Core Tools<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> with the <a href="/env">prerequisites</a>. It will provide the <code>func</code> CLI that you can use to test your functions and deploy them to Azure.</p> <p>Now let's test our API running on a function:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> run start:azure
</code></pre></div><p>If everything is working well, at some point you should see this log in the console:</p> <div class="language- extra-class"><pre class="language-text"><code>Now listening on: http://0.0.0.0:7071
Application started. Press Ctrl+C to shut down.

Http Functions:

        main:  http://localhost:7071/api/{*segments}
</code></pre></div><p>That means that your API should be working on port <code>7071</code>, let's test it again using curl:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">curl</span> http://localhost:7071/api/stories/random
</code></pre></div><h2 id="create-the-resources"><a href="#create-the-resources" class="header-anchor">#</a> Create the resources</h2> <p>Now that your API is ready to run on Functions, let's deploy it to the real thing!</p> <p>First, we have to create some Azure resources. For that we will use the Azure CLI commands:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># Login to Azure, should only be needed once</span>
az login

<span class="token comment"># Create a new resource group</span>
az group create --name funpets --location northeurope

<span class="token comment"># Create the storage account</span>
<span class="token comment"># This name must be globally unique, so change it with your own</span>
<span class="token comment"># /!\ ONLY lowercase alphanumeric characters are allowed here /!\</span>
<span class="token comment"># (no underscore or hyphen)</span>
az storage account create --name <span class="token operator">&lt;</span>your-funpets-storage<span class="token operator">&gt;</span> <span class="token punctuation">\</span>
                          --resource-group funpets <span class="token punctuation">\</span>
                          --kind StorageV2

<span class="token comment"># Create the function app</span>
<span class="token comment"># This name must be globally unique, so change it with your own</span>
az functionapp create --name <span class="token operator">&lt;</span>your-funpets-api<span class="token operator">&gt;</span> <span class="token punctuation">\</span>
                      --resource-group funpets <span class="token punctuation">\</span>
                      --consumption-plan-location northeurope <span class="token punctuation">\</span>
                      --storage-account <span class="token operator">&lt;</span>your-funpets-storage<span class="token operator">&gt;</span>
</code></pre></div><p>The first thing we created is a <a href="https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview?WT.mc_id=nitro-workshop-yolasors#resource-groups" target="_blank" rel="noopener noreferrer"><strong>resource group</strong><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, a collection of Azure resources. It's typically used to group related resources for an application, by environment (production vs testing for example) or anything as needed.</p> <p>Then we added a <a href="https://docs.microsoft.com/azure/storage/common/storage-introduction?WT.mc_id=nitro-workshop-yolasors#azure-storage-services" target="_blank" rel="noopener noreferrer"><strong>storage account</strong><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> that will be used to store our app data, files, and even application code.</p> <p>Finally, we added a <a href="https://docs.microsoft.com/azure/azure-functions/functions-overview?WT.mc_id=nitro-workshop-yolasors" target="_blank" rel="noopener noreferrer"><strong>function app</strong><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> on which you will deploy your API.</p> <h2 id="deploy-your-app"><a href="#deploy-your-app" class="header-anchor">#</a> Deploy your app</h2> <p>To make deployment easier and faster for this workshop we will add a bit of specific configuration to your function app:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># Don't forget to change the name with your own</span>
az functionapp config appsettings <span class="token builtin class-name">set</span> --name <span class="token operator">&lt;</span>your-funpets-api<span class="token operator">&gt;</span> <span class="token punctuation">\</span>
                                      --resource-group funpets <span class="token punctuation">\</span>
                                      --settings <span class="token string">&quot;SCM_DO_BUILD_DURING_DEPLOYMENT=true&quot;</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">Important</p> <p>Edit the <code>.funcignore</code> file and add a line with <code>node_modules</code> at the bottom.</p></div> <p>The <code>SCM_DO_BUILD_DURING_DEPLOYMENT=true</code> setting will enable a &quot;build&quot; step for zip deployments, which for Node.js apps translates to <code>npm install</code> being called on the server directly.
This way you don't have to package the required <code>node_modules</code> with your app, reducing upload times a lot.</p> <p>Now that we have the resources created and configured on Azure, we can use the <code>func</code> CLI to deploy our API:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># Build your app</span>
<span class="token function">npm</span> run build

<span class="token comment"># Create an archive from your local files and publish it</span>
<span class="token comment"># Don't forget to change the name with the one you used previously</span>
func azure functionapp publish <span class="token operator">&lt;</span>your-funpets-api<span class="token operator">&gt;</span> --nozip
</code></pre></div><p>After publishing, you should see in the console the URL you can use to invoke the function, like this:</p> <div class="language- extra-class"><pre class="language-text"><code>Functions in funpets-api:
    main - [httpTrigger]
        Invoke url: https://&lt;your-funpets-api&gt;.azurewebsites.net/api/{*segments}
</code></pre></div><p>We can invoke our trusty <code>curl</code> command again to check the deployment using the previous URL:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">curl</span> https://<span class="token operator">&lt;</span>your-funpets-api<span class="token operator">&gt;</span>.azurewebsites.net/api/stories/random
</code></pre></div><p>Server deployment, done ✔️.</p> <div class="custom-block tip"><p class="custom-block-title">Pro tip #1</p> <p>When working on a production app, you should not deploy directly from your local source code, but rather connect your source code repository to a continuous integration and deployment system (CI/CD). You can either do that using <a href="https://docs.microsoft.com/azure/devops-project/azure-devops-project-github?WT.mc_id=nitro-workshop-yolasors" target="_blank" rel="noopener noreferrer">Azure DevOps<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or directly connect your repository for deployment using this command:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>az functionapp deployment <span class="token builtin class-name">source</span> config --name <span class="token operator">&lt;</span>your-funpets-api<span class="token operator">&gt;</span> <span class="token punctuation">\</span>
                                        --resource-group funpets <span class="token punctuation">\</span>
                                        --repo-url <span class="token operator">&lt;</span>your-git-repo-url<span class="token operator">&gt;</span>
</code></pre></div></div> <div class="custom-block tip"><p class="custom-block-title">Pro tip #2</p> <p>For this workshop, we use the <code>--nozip</code> option for deployment to disable the <em>Run-From-Package</em> mode that runs the app directly from a read-only zip package. This is needed to run <code>npm install</code> remotely thanks to the <code>SCM_DO_BUILD_DURING_DEPLOYMENT=true</code> setting, to reduce upload times. But for production environments, you should avoid using that as your application startup time is slightly longer when <code>--nozip</code> option is used. Make sure the <code>.funcignore</code> file no longer contains the earlier added line with <code>node_modules</code>, else the zip deployment won't contain the node_modules folder.</p></div> <br> <hr> <p><strong>Solution:</strong> see the <a href="https://github.com/nitro-stack/nitro-workshop/tree/step2" target="_blank" rel="noopener noreferrer">code for step 2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/nitro-workshop/step1/" class="prev">1. Bootstrap project</a></span> <span class="next"><a href="/nitro-workshop/step3/">3. Add database</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/nitro-workshop/assets/js/app.72f1e144.js" defer></script><script src="/nitro-workshop/assets/js/2.37837671.js" defer></script><script src="/nitro-workshop/assets/js/10.2d5da0ed.js" defer></script>
  </body>
</html>
